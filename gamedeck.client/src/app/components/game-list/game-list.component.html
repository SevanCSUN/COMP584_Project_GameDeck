<div class="game-list-container">
  <div class="page-header">
    <h1>Video Games</h1>
    <a routerLink="/games/new" class="add-btn">+ Add Game</a>
  </div>

  <div class="filter-section">
    <label for="consoleFilter">Filter by Console:</label>
    <select
      id="consoleFilter"
      [(ngModel)]="selectedConsoleId"
      (change)="onConsoleFilterChange()"
      class="filter-select">
      <option [ngValue]="null">All Consoles</option>
      @for (console of (consoles$ | async); track console.id) {
          <option [ngValue]="console.id">
            {{ console.manufacturer }} {{ console.name }}
          </option>
        }
    </select>
    @if (selectedConsoleId) {
      <button (click)="clearFilter()" class="clear-btn">Clear Filter</button>
    }
  </div>
  @if (error) {
    <div class="error">{{ error }}</div>
  }

  @if ((games$ | async); as games) {
    @if (!error && games.length > 0) {
    <table class="game-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Platform</th>
          <th>Release Date</th>
          <th>Genre</th>
          <th>Developer</th>
          <th>Players</th>
        </tr>
      </thead>
      <tbody>
        @for (game of games; track $index) {
          <tr
            class="clickable"
            role="link"
            tabindex="0"
            (click)="goToGame(game.id)"
            (keydown.enter)="goToGame(game.id)">
            <td>{{ game.id }}</td>
            <td>
              <strong>{{ game.title }}</strong>
            </td>
            <td>{{ game.platformName || 'N/A' }}</td>
            <td>{{ game.releaseDate | date:'shortDate' }}</td>
            <td>{{ game.genre }}</td>
            <td>{{ game.developer }}</td>
            <td>{{ game.numPlayers || 'N/A' }}</td>
          </tr>
        }
      </tbody>
    </table>
    }

    @if (!error && games.length === 0) {
      <div class="no-data">
        No games found.
      </div>
    }
  }
</div>

